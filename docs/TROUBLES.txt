
Проблемы проектирования.

01.

Как передавать ссылку на стрим в класс PeImage создаваемый за его пределами?
Ситуация: Существуют два вида образов PE: в файле и в памяти. Чтобы не привязы-
аться к способу хранения в класс передается стрим. Есть три варианта по передаче
cтрима:

1. Создать три вида PeImage: InputPeImage, OutputPeImage и InOutPeImage. В клиен-
   тском коде открываать std::istream, std::ostream или std::iostream и передавать
   в соответствующую версию PeImage.
2. В класс PeImage передавать std::iostream, а внешне создать его либо по чтению,
   либо по записи. В коде PeImage различать ошибки возникаемые при записи в стрим,
   первый тип ошибки это когда открыто на readonly и второй когда от операц.систе-
   мы.
3. Работать со streambuf.

Ответ: вариант №2
Обоснование: Вариант №1 имел бы смысл, если в коде стримов из стандартной библио-
теки и нам бы тогда нужно было защищищать источник от попыток записи. Но в стан-
дартной библиотеке стримы устрены так, что при попытках записи в стримы открытые
по чтению реальный объект(к примеру файл) не меняется, а выставляется флаг:
std::stream::badbit.

-------------------------------------------------------------------------------

02. 

Какой должен быть интерфейс у класса PeImage для обеспечения доступа к массиву
признаком конца которого является нулевой объект и как писать код, чтобы работа с
этим массивом была эффективной?

-------------------------------------------------------------------------------

