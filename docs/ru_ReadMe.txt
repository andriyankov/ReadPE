
Read Portable Executable
2012 - 2022 (c) ntvisigoth@gmail.com


Содержание
----------

	- Назначение
	- Требования к утилите
	- Дизайн утилиты
	- Описание возможностей
	- Тестирование утилиты
	- Обзор опций командной строки
	- Примеры использования
	- Запланированные возможности
	- Контакты

Назначение
----------

	Утилита предназначена для работы с файлами PE32/PE32+ форматов. Основной
	целью является выдача значений заголовков "как есть", а дополнительной
	аналитическая. Анализируя программа выдает различные вспомогательные зна-
	чения такие как энтропия секции, реальное файловое смещение и др.

Требования к утилите
--------------------

	- Работать с 32 и 64 битными образами;
	- Работать под MS Windows 7, Windows 8;
	- Выдавать код ошибки в return при выходе из main();
	- Результат выводить в виде JSON-формата(www.json.org);
	- Интерфейс утилиты должен быть похож на UNIX-утилиту readelf (см. readelf --help);
	- На не поддерживаемых PE-типах выводить "Unsupported"(к примеру для ARM);

Дизайн утилиты
---------------

	Утиллита спроектирована в виде команды без какого-либо участия человека.
	Для того чтобы повлиять на получаемый результат пользователь может задать 
	опции, флаги в командной строке.

	Все опции командной строки делятся на два типа: 'raw' и 'detailed'. Первый
	тип опции дает возможность получить значения заголовков в файле в том виде 
	в каком они содержатся в файле. Второй тип опций аналитический и служит	как
	представления некоторых подробностей так и результатов некоторых типов ана-
	лиза. Примерами являются адреса tls-callback функций, текстовое представле-
	ние флагов, энтропия секция, отображение перехваченных функций в таблице
	импорта.

	Результат оформляется в виде json объекта, это решение связано со стремлением
	автора ускорить разработку Python-скриптов.

	С целью упрощения работы с командной строкой был внедрена возможность исполь-
	зования файла-ответа. Такой возможностью пользователь может воспользоваться
	используя символ '@' и передав файловый путь к файлу-ответа.

Описание возможностей
---------------------

	Файла-ответа (response-file), доступный после символа '@' представляет из себя
	с опциями командной строки, которые будут переданы при вызове утилиты.

	Таблица описателей секций:
	- Наименование;
	- Текстовое описание характеристик;
	- Значение информационной энтропии;
	- Действительное файловое смещение.

	Экспортируемые элементы:
	- Наименование;
	- RVA;
	- Файловое смещение;
	- Наименование перенаправляемых элементов.
	
	Tls-директория:
	- RVA;
	- Файловые смещения для каждой callback-функций.

	Привязанные импортируемые элементы(Bound import):
	- RVA;
	- Файловое смещение наименования модуля;
	- Наименование модуля;
	- Временная метка.

	Импортируемые элементы:
	- Наименование модуля;
	- Наименование элемента;
	- Ординал элемента;
	- RVA элемента;
	- Файловое смещение элемента;
	- RVA и файловое смещение спрятанной hook-функции находящейся в модуле;
	- Помечаются перенаправляемые элементы.

	Таблица перемещаемых элементов:
	- RVA;
	- Файловое смещение;
	- Тип каждой поправки.

Тестирование утилиты
--------------------

	- Набор файлов известный как "corkami"
	- Набор извратных файлов от Neox, которые применялись для тестирования PE Tools

Обзор опций командной строки
----------------------------

	Внимание: Названия опций чувствительны к регистру(UNIX-стиль)

	@<responce-file>
	Так задается передача пути к файлу с опциями командной строки.

	--donate
	Вывод на STDOUT Yandex и QIWI кошельков для поддержки проекта

	--help
	Вывод на STDOUT справочного сообщения

	--nologo
	Запрет вывода в STDOUT copyright-сообщения

	--version
	Вывод в STDOUT версии утилиты

	--raw
	Вывести все заголовки и описатели секций. Эквивалентно -d -n -s.

	--detailed
	Вывести все подробности . Эквивалентно -S, -E, -I, -T, -B.

	--all
	Эквивалентно включению всех аналитических и основных опций.

	-d [ --dos-header ]
	Вывести значения DOS-заголовка

	-n [ --nt-headers ]
	Вывести значения NT-заголовков

	-s [ --sections ]
	Вывести таблицу описателей секций

	-e [ --export ]
	Вывести заголовок экпортируемых элементов

	-i [ --imports ]
	Вывести таблицу заголовков импортируемых модулей

	--tls
	Вывести описатель TLS директории

	--bounds
	Вывести таблицу заголовков "нового" типа привязки импортируемых элементов

	--relocations
	Вывести таблицу блоков описателей блоков поправок

	-S [ --sections-detailed ]
	Вывести в подробном виде таблицу описателей секций

	-E [ --export-detailed ]
	Вывести в подробном виде информацию об экспортируемых элементах

	-I [ --imports-detailed ]
	Вывести в подробном виде об импортируемых модулях и элементах из них

	--load-confg
	Вывести заголовок Load Config Directory

	-T [ --tls-detailed ]
	Вывести в подробном виде о TLS-директории и возможных TLS-Callback функциях

	-B [ --bounds-detailed ]
	Вывести в подробном виде о "привязанных" импортируемых элементах

	--relocations-detailed
	Вывести в подробном виде информацию о поправках

Примеры использования
---------------------

	readpe.exe --nologo -d --tls d:\cthulhu.exe
	  Выведет только DOS заголовок и описатель TLS директории

	readpe.exe --tls-detailed @d:\my-research\response_file.txt d:\cthulhu.exe
	  Выдаст в подробном виде о TLS-директории, а также будут применены опции 
	  указанные в файле response_file.txt

Запланированные возможности
---------------------------

	1.
	Добавление нового флага --mapping для задания эмуляции проецирования обра-
	за в память.

	2.
	Работа с ресурсами.

	3.
	Поддержка чтения и анализа EFI-образов.

	4.
	Поддержка чтения и анализа .NET образов.

	5.
	Поддержка вывода технических деталей для заголовков и таблиц описателей.
	К примеру в подробном выводе об импорте можно вывести "Headers table File 
	offset" и "Headers table File size"

	6.
	Создать версии утилиты для FreeBSD, Linux и Mac

Как поддержать проект
---------------------

	Автор развивает проект в свободное от работы и семьи время. Вы можете выра-
	зить благодарность и поддержать материально используя опцию командной строки
	'--donate'.

Контакты
--------

	Связаться с автором можно написав ему по e-mail: ntvisigoth@gmail.com

	Автор всегда открыт для диалога по развитию утилиты. Пишите чтобы сообщить
	о программной ошибке, возможном улучшении или узнать какие-либо подробности. 
